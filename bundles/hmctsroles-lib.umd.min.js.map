{"version":3,"sources":["ng://hmctsroles-lib/lib/hmctsroles-lib.service.ts","ng://hmctsroles-lib/lib/hmctsroles-lib.component.ts","ng://hmctsroles-lib/lib/directives/roles.directive.ts","ng://hmctsroles-lib/lib/directives/unless-role-includes.directive.ts","ng://hmctsroles-lib/lib/hmctsroles-lib.module.ts"],"names":["HmctsrolesLibService","cookieService","this","prototype","getUserRoles","roles","ck","get","split","console","log","Injectable","args","providedIn","CookieService","HmctsrolesLibComponent","ngOnInit","Component","selector","template","styles","RolesDirective","viewContainerRef","templateRef","auth","Object","defineProperty","value","_roleAccess","_roleList","_roleSource","checkRoleisValid","createEmbeddedView","clear","_this","some","r","includes","Directive","ViewContainerRef","TemplateRef","Input","UnlessRoleIncludesDirective","elr","authorised","roleList","nativeElement","style","visibility","unlessRole","ElementRef","HmctsrolesLibModule","NgModule","imports","CookieModule","forRoot","declarations","exports"],"mappings":"oTAAA,IAAAA,EAAA,WAQE,SAAAA,EACUC,GAAAC,KAAAD,cAAAA,SAUHD,EAAAG,UAAAC,wBACL,IAAIC,EAAQ,GACRC,EAAKJ,KAAKD,cAAcM,IAAI,aAGhC,OAFU,MAAND,IAAYD,EAAQC,EAAGE,MAAM,MACjCC,QAAQC,IAAI,YAAaL,GAClBA,uBArBVM,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDAHLC,EAAAA,iJADT,GCAAC,EAAA,WAaE,SAAAA,YAEAA,EAAAZ,UAAAa,SAAA,iCAbDC,EAAAA,UAASL,KAAA,CAAC,CACTM,SAAU,uBACVC,SAAU,uDAKVC,OAAQ,+CATV,GCAAC,EAAA,WA2CE,SAAAA,EACUC,EACAC,EACAC,GAFAtB,KAAAoB,iBAAAA,EACApB,KAAAqB,YAAAA,EACArB,KAAAsB,KAAAA,kBANE,SAxBZC,OAAAC,eACIL,EAAAlB,UAAA,aAAU,KADd,SACewB,GACbzB,KAAK0B,YAAcD,EACnBlB,QAAQC,IAAI,eAAgBiB,oCAK9BF,OAAAC,eACIL,EAAAlB,UAAA,qBAAkB,KADtB,SACuBwB,GACrBzB,KAAK2B,UAAYF,EACjBlB,QAAQC,IAAI,aAAciB,oCAM5BF,OAAAC,eACIL,EAAAlB,UAAA,uBAAoB,KADxB,SACyBwB,GACvBzB,KAAK4B,YAAcH,EACnBlB,QAAQC,IAAI,eAAgBiB,oCAa9BN,EAAAlB,UAAAa,SAAA,WAG0B,UAApBd,KAAK4B,YACP5B,KAAKG,MAAQH,KAAKsB,KAAKpB,eAEvBF,KAAKG,MAAQH,KAAK2B,UAGP3B,KAAK6B,mBAGhB7B,KAAKoB,iBAAiBU,mBAAmB9B,KAAKqB,aAG9CrB,KAAKoB,iBAAiBW,SAK1BZ,EAAAlB,UAAA4B,iBAAA,WAAA,IAAAG,EAAAhC,KACE,OAAOA,KAAKG,MAAM8B,KAAK,SAAAC,GAAK,OAAAF,EAAKN,YAAYS,SAASD,0BA9DzDE,EAAAA,UAAS1B,KAAA,CAAC,CACTM,SAAU,4DARCqB,EAAAA,wBAAkBC,EAAAA,mBAEtBxC,yCAaNyC,EAAAA,kCAQAA,EAAAA,oCASAA,EAAAA,WAjCH,GCAAC,EAAA,WAcE,SAAAA,EACUC,EACAnB,GADAtB,KAAAyC,IAAAA,EACAzC,KAAAsB,KAAAA,SAMVkB,EAAAvC,UAAAa,SAAA,WAEE,IAAI4B,EACJ1C,KAAKG,MAAQH,KAAK2C,SAASrC,MAAM,KAEjCoC,EAAa1C,KAAK6B,mBAClBtB,QAAQC,IAAI,OAAQkC,GAElB1C,KAAKyC,IAAIG,cAAcC,MAAMC,WAD3BJ,EACwC,SAGA,WAO9CF,EAAAvC,UAAA4B,iBAAA,WAAA,IAAAG,EAAAhC,KACE,OAAOA,KAAKG,MAAM8B,KAAK,SAAAC,GAAK,OAAAF,EAAKe,WAAWzC,MAAM,KAAK6B,SAASD,0BArCnEE,EAAAA,UAAS1B,KAAA,CAAC,CACTM,SAAU,4DALQgC,EAAAA,kBACXlD,yCAQNyC,EAAAA,wBACAA,EAAAA,0BACAA,EAAAA,WAXH,GCAAU,EAAA,oDAMCC,EAAAA,SAAQxC,KAAA,CAAC,CACRyC,QAAS,CACPC,EAAAA,aAAaC,WAEfC,aAAc,CAACzC,EAAwBM,EAAgBqB,GACvDe,QAAS,CAAC1C,EAAwBM,EAAgBqB,SAXpD","sourcesContent":["import { Inject, Injectable } from '@angular/core';\r\nimport { CookieService } from 'ngx-cookie';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HmctsrolesLibService {\r\n\r\n  constructor(\r\n    private cookieService: CookieService) { }\r\n\r\n\r\n\r\n  // public getUserRoles(): string[] {\r\n  //   let roles = ['roleA', 'roleB', 'roleC']\r\n  //   return roles\r\n  // }\r\n\r\n\r\n  public getUserRoles(): string[] {\r\n    let roles = [];\r\n    let ck = this.cookieService.get('__roles__');\r\n    if (ck != null) roles = ck.split(',');\r\n    console.log('@@COOKIE:', roles)\r\n    return roles\r\n\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'hmcts-hmctsroles-lib',\r\n  template: `\r\n    <p>\r\n      hmctsroles-lib works!\r\n    </p>\r\n  `,\r\n  styles: []\r\n})\r\nexport class HmctsrolesLibComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import {\r\n  Directive, ViewContainerRef, TemplateRef, Input, OnInit\r\n} from \"@angular/core\";\r\nimport { HmctsrolesLibService } from \"../hmctsroles-lib.service\";\r\n\r\n\r\n\r\n\r\n@Directive({\r\n  selector: \"[roleAccess]\"\r\n})\r\nexport class RolesDirective implements OnInit {\r\n  // @Input() roleAccess: string;\r\n  // @Input() roleAccessroleList: string;\r\n\r\n  private _roleAccess: string;\r\n  @Input()\r\n  set roleAccess(value: string) {\r\n    this._roleAccess = value;\r\n    console.log('roleAccess: ', value);\r\n  }\r\n\r\n\r\n  private _roleList: string[];\r\n  @Input()\r\n  set roleAccessRoleList(value: string[]) {\r\n    this._roleList = value;\r\n    console.log('roleList: ', value);\r\n  }\r\n\r\n\r\n\r\n  private _roleSource: string;\r\n  @Input()\r\n  set roleAccessRoleSource(value: string) {\r\n    this._roleSource = value;\r\n    console.log('roleSource: ', value);\r\n  }\r\n\r\n\r\n  isVisible = false;\r\n  roles: any[];\r\n\r\n  constructor(\r\n    private viewContainerRef: ViewContainerRef,\r\n    private templateRef: TemplateRef<any>,\r\n    private auth: HmctsrolesLibService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    let authorised\r\n\r\n    if (this._roleSource == 'cookie')\r\n      this.roles = this.auth.getUserRoles()\r\n    else\r\n      this.roles = this._roleList;\r\n\r\n\r\n    authorised = this.checkRoleisValid()\r\n\r\n    if (authorised)\r\n      this.viewContainerRef.createEmbeddedView(this.templateRef)\r\n\r\n    else\r\n      this.viewContainerRef.clear()\r\n\r\n  }\r\n\r\n\r\n  checkRoleisValid() {\r\n    return this.roles.some(r => this._roleAccess.includes(r))\r\n  }\r\n}\r\n","import { Directive, ElementRef, OnInit, Input, ViewContainerRef, TemplateRef } from '@angular/core';\r\nimport { HmctsrolesLibService } from '../hmctsroles-lib.service';\r\n\r\n\r\n@Directive({\r\n  selector: \"[unlessRole]\"\r\n})\r\nexport class UnlessRoleIncludesDirective implements OnInit {\r\n\r\n  @Input() unlessRole: string;\r\n  @Input() roleList: string;\r\n  @Input() roleSource: string;\r\n  roles: any;\r\n\r\n  constructor(\r\n    private elr: ElementRef,\r\n    private auth: HmctsrolesLibService\r\n  ) {\r\n\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n\r\n    let authorised\r\n    this.roles = this.roleList.split(',')\r\n\r\n    authorised = this.checkRoleisValid()\r\n    console.log('auth', authorised)\r\n    if (authorised)\r\n      this.elr.nativeElement.style.visibility = 'hidden'\r\n\r\n    else\r\n      this.elr.nativeElement.style.visibility = 'visible'\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n  checkRoleisValid() {\r\n    return this.roles.some(r => this.unlessRole.split(',').includes(r))\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { HmctsrolesLibComponent } from './hmctsroles-lib.component';\r\nimport { RolesDirective } from './directives/roles.directive';\r\nimport { UnlessRoleIncludesDirective } from './directives/unless-role-includes.directive';\r\nimport { CookieModule } from 'ngx-cookie';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CookieModule.forRoot()\r\n  ],\r\n  declarations: [HmctsrolesLibComponent, RolesDirective, UnlessRoleIncludesDirective],\r\n  exports: [HmctsrolesLibComponent, RolesDirective, UnlessRoleIncludesDirective]\r\n})\r\nexport class HmctsrolesLibModule { }\r\n"]}